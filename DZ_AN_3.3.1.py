import pandas as pd

# Загрузка данных из CSV файла
df = pd.read_csv('divan_products.csv')

# Вывод первых строк для проверки структуры данных
print("Структура данных:")
print(df.head())

# Проверка доступных столбцов
print("\nДоступные столбцы:")
print(df.columns)

# Убедитесь, что столбец с ценами называется правильно, например 'Цена'
# Если название столбца отличается, замените 'Цена' на фактическое название столбца
if 'Цена' in df.columns:
    # Очистка цен от символов валюты и пробелов, преобразование в числовой формат
    df['Цена'] = df['Цена'].replace({'₽': '', ',': '.', 'руб.': '', ' ': ''}, regex=True)

    # Преобразование в числовой формат с обработкой возможных ошибок
    df['Цена'] = pd.to_numeric(df['Цена'], errors='coerce')

    # Оставляем только столбец с ценами
    price_df = df[['Цена']]

    # Сохранение обработанных данных в новый CSV файл
    price_df.to_csv('divan_prices.csv', index=False)
    print("\nОбработанные данные сохранены в 'divan_prices.csv'.")
else:
    print("\nСтолбец с ценами не найден. Проверьте название столбца.")